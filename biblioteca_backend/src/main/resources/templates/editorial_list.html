import React, { Component } from "react";
import { withRouter } from "react-router-dom";
import { DataTable } from "primereact/datatable";
import { Column } from "primereact/column";
import EditorialServicio from "../service/EditorialServicio";
import { Button } from "primereact/button";
import PropTypes from "prop-types";

const EditorialWithRouter = withRouter(({ history }) => {
static propTypes = {
history: PropTypes.shape({
push: PropTypes.func.isRequired,
}).isRequired,
};

constructor() {
super();
this.state = {
editorial: null,
};
this.editorialServicio = new EditorialServicio();
}

componentDidMount() {
this.editorialServicio.getAll().then((data) => {
if (data) {
this.setState({ editorial: data });
} else {
console.log("No data returned from API");
}
});
}

actionTemplate = (rowData) => {
return (
<Button
        label="Modificar"
        onClick={() => history.push(`/modificar/${rowData.id}`)}
/>
);
};

render() {
if (!this.state.editorial) {
return <div>Loading...</div>;
}

return (
<div>
    <h1 className="titulo-pag">Listado de Editoriales</h1>
    <DataTable
            value={this.state.editorial}
            paginator
            rows={5}
            rowsPerPageOptions={[5, 10, 25, 50]}
            tableStyle={{ minWidth: "50rem" }}>
    <Column field="nombre" header="Nombre" />
    <Column field="id" header="Id" />
    <Column body={this.actionTemplate} header="Acciones" />
    </DataTable>
</div>
);
}

return EditorialWithRouter;
});

export default EditorialWithRouter;